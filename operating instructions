User instructions for Raduino_v1.10

After the version update all calibration data, drive level settings, etc will be erased.
Before updating note down your cal values etc. After the update use the Function Button to set them back again.

10-TURN TUNING POT
The default tuning range with the standard supplied 1-turn tuning pot is only 50 kHz.
If you install a 10-turn pot instead you can extend the tuning range for full 40m band coverage.
Using the Function Button, go to the SETTINGS menu and set the desired tuning range.

Don't have a Function Button yet?
If you don't install a pushbutton then the basic functions will still work.
(of course you will miss the dual VFO, RIT and USB capability then).
Calibration can still be done in the old fashioned way using the CAL button (pin A2 - red wire).
The tuning range setting can be 'hard coded' by uncommenting line 1260 and adapting the value to your needs.

PTT SENSE WIRING:
Connect pin A0 (black wire) via a 10K resistor to the output of U3 (LM7805 regulator) on the BITX40 board.
See https://github.com/amunters/bitx40/blob/master/PTT%20SENSE%20wiring.png
When the PTT is not pressed (RX mode), the regulator will be off, so pin A0 will see 0V (LOW).
When the PTT is pressed (TX mode), the regulator will be on, so pin A0 will see +5V (HIGH).
The PTT SENSE is only required for the RIT (SPLIT) functionality, and for disabling frequency updating during TX
(to prevent "FM-ing"). If you don't install the PTT sense everything else will still work normally.

CW-CARRIER WIRING:
Connect a wire from Raduino ouput D6 (connector P3, pin 15), via a 47K series resistor, to the input of the mixer.
See https://github.com/amunters/bitx40/blob/master/CW-CARRIER%20wiring.png
When the key is down ouput D6 will be HIGH. This injects some DC current into the mixer so that it becomes unbalanced.
As a result a CW carrier will be generated.
The CW-CARRIER is only required for CW functionality. If you don't install this line everything else
will still work normally.

CW sidetone WIRING:
A sidetone is available at Raduino output D5 (connector P3, pin 14). This signal can be fed to the speaker/headphones
in parallel to the output from the existing audio amplifier.
See https://github.com/amunters/bitx40/blob/master/sidetone%20wiring.png
The desired sidetone pitch can be set using the Function Button in the SETTINGS menu.
The CW-sidetone is only used for CW operation. If you don't install this line everything else
will still work normally.

TX-RX WIRING:
See https://github.com/amunters/bitx40/blob/master/TX-RX%20line%20wiring.png
When the key is down output D7 will be HIGH. It will only go LOW again when the key has been up for at least 250 ms.
This signal is used to drive an NPN transistor which is connected in parallel to the existing PTT switch, so that it will
bypass the PTT switch during CW operation. As as result the relays will be activated as long as D7 is HIGH.
(Suggestion: If you have a combined microphone/PTT connector, the PTT bypass transistor can be soldered directly on the
back of it).
The TX-RX is currently only required for CW semi break-in functionality. If you don't install this line CW operation is
still possible but you will need to manually press the PTT switch to transmit.
(The PTT bypass transistor may be used in the future for VOX functionality as well).

FUNCTION BUTTON WIRING:
Connect a momentary pushbutton between pin A3 (orange wire) and ground.
Arduino's internal pull-up resistors are used, therefore do NOT install an external pull-up resistor!

FUNCTION BUTTON USAGE:

Several functions are available with just one pushbutton.
In normal operation mode:
1 short press - toggle VFO A/B
2 short presses - toggle RIT on/off (PTT sense is required for this function)
3 short presses - toggle LSB/USB mode
long press (> 2 seconds) - VFO A=B

When you press the Fbutton VERY long (>5 seconds) you will enter the SETTINGS menu.
In the SETTINGS menu:

1 short press - VFO frequency calibration in LSB mode

  - use another transceiver to generate a carrier at a known frequency (for example 7100.0 kHz)
    (or ask a friend to transmit a carrier at a known frequency)
  - before going into the calibration mode, first set the VFO to 7100.0 kHz in LSB mode
    (the received signal may not yet be zero beat at this point)
  - go into the LSB calibration mode (1 short press)
  - using the tuning pot, adjust the LSB offset for exactly zero beat
  - press the Function Botton again to save the setting
  
2 short presses - VFO frequency calibration in USB mode

  - USB calibration depends on LSB calibration, so make sure that LSB calibration has been done first!
  - use another transceiver to generate a carrier at a known frequency (for example 7100.0 kHz)
    (or ask a friend to transmit a carrier at a known frequency)
  - before going into the calibration mode, first set the VFO to 7100.0 kHz in USB mode
    (the received signal may not yet be zero beat at this point)
  - go into the USB calibration mode (2 short presses)
  - using the tuning pot, adjust the USB offset for exactly zero beat
  - press the Function Botton again to save the setting
  
3 short presses - set VFO drive level in LSB mode

  - tune to 7199 kHz, on most BITX40 transceivers a strong birdie is heard
  - give 3 short presses to the FB to enter the VFO drive level adjustment
  - the default drive level in LSB mode is 4mA
  - using the tuning pot, try different drive levels (2,4,6,8 mA) to minimize the strength of the birdie
  - press the FB again to save the setting
  
4 short presses - set VFO drive level in USB mode

  - tune to a weak signal
  - give 4 short presses to the FB to enter the VFO drive level adjustment
  - the default drive level in USB mode is 8mA
  - using the tuning pot, try different drive levels (2,4,6,8 mA) for maximum signal to noise ratio
  - press the FB again to save the setting
  Extra Note: If the max. drive level of 8mA is still insufficient for USB mode, removal of C91 and C92 may help.
  These caps cause too much attenuation of the VFO signal at higher frequencies. They're only needed for the analog VFO
  and can safely be removed if you use the Raduino instead of the analog VFO.

5 short presses - set tuning range

  - the default tuning range is 50 kHz (7100-7150 kHz), this is OK for a standard 1-turn pot
  - if you install a multi-turn pot instead you can extend the tuning range
  - using the tuning pot, set the desired tuning range
  - recommended value: 50 kHz for a 1-turn pot, 200 kHz for a 10-turn pot
  - press the FB again to save the setting

6 short presses - set sidetone pitch

 - the sidetone is generated
 - using the tuning pot set the desired sidetone pitch
 - press the FB again to save the setting
 
long press (>2 seconds) - return to the NORMAL mode

All user settings are stored in EEPROM and retrieved during startup.

When you keep the Fbutton pressed during power on all user settings will be erased and set back to "factory" values:
VFO calibration (LSB): 0
VFO offset (USB): 1500 Hz
VFO drive level (LSB): 4mA
VFO drive level (USB): 8mA
Tuning pot range: 50 kHz
Mode LSB for both VFO A and B
Side tone: 800 Hz

A warning message "uncalibrated" will be displayed until you recalibrate the VFO again.
